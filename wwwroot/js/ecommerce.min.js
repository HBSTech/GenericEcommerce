/*! For license information please see ecommerce.min.js.LICENSE.txt */
(()=>{"use strict";var e={"./src/implementation/AddToCartRepo.ts":(e,t,o)=>{o.r(t),o.d(t,{AddToCartRepo:()=>r});var s=o("./src/implementation/EcommerceClassRepo.ts"),n=function(e,t,o,s){return new(o||(o=Promise))((function(n,r){function a(e){try{m(s.next(e))}catch(e){r(e)}}function c(e){try{m(s.throw(e))}catch(e){r(e)}}function m(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}m((s=s.apply(e,t||[])).next())}))};class r{addItem(e){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/ShoppingCart/Add",{method:"POST",body:s.EcommerceClassRepo.getJSON(e.detail),headers:s.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.message&&document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))}))}))}addToCartEvent(e){var t={};Object.keys(e.dataset).filter((function(e){return/^customField/.test(e)})).forEach((function(o){t[o]=e.dataset[o]||""}));var o={sKUGUID:e.dataset.sku,quantity:e.dataset.quantity};return Object.keys(t).length>0&&(o.customFields=t),new CustomEvent("add-to-cart",{detail:o})}}},"./src/implementation/CheckoutRepo.ts":(e,t,o)=>{o.r(t),o.d(t,{CheckoutRepo:()=>r});var s=o("./src/implementation/EcommerceClassRepo.ts"),n=function(e,t,o,s){return new(o||(o=Promise))((function(n,r){function a(e){try{m(s.next(e))}catch(e){r(e)}}function c(e){try{m(s.throw(e))}catch(e){r(e)}}function m(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}m((s=s.apply(e,t||[])).next())}))};class r{constructor(){this.paymentEvent=new Event("payment"),this.orderGUID="",this.createOrderEvent=new Event("create-order"),this.updateOrderEvent=new Event("update-order"),this.getCountriesEvent=new Event("get-countries"),this.customerCreated=null!=document.body.querySelector(".customer[data-customerexists]"),this.getAddressesEvent=new Event("get-addresses")}redeemCouponEvent(e){return new CustomEvent("redeem-coupon",{detail:e})}removeCouponEvent(e){return new CustomEvent("remove-coupon",{detail:e})}getStatesEvent(e,t){return new CustomEvent("get-states",{detail:{selectId:e,countryId:t}})}getAddressEvent(e,t){return new CustomEvent("get-address",{detail:{addressID:e,addressType:t}})}paymentResultEvent(e){return new CustomEvent("payment-result",{detail:e})}setCustomerEvent(e){return new CustomEvent("set-customer",{detail:e})}setBillingAddressEvent(e){return new CustomEvent("set-billing-address",{detail:e})}setShippingAddressEvent(e){return new CustomEvent("set-shipping-address",{detail:e})}setShippingOptionEvent(e){return new CustomEvent("set-shipping-option",{detail:e})}setPaymentOptionEvent(e){return new CustomEvent("set-payment-option",{detail:e})}getOrder(){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/Checkout/GetOrder").then((e=>e.text())).then((e=>e)).catch((e=>(document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message)),null)))}))}getShippingOptions(e){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/Checkout/GetShippingOptions").then((e=>e.json())).then((t=>{s.EcommerceClassRepo.applyDropdownList(e,t)})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))}))}))}getPaymentOptions(){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/Checkout/GetPaymentOptions").then((e=>e.json())).then((e=>e)).catch((e=>(document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message)),null)))}))}getCountries(e){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/Checkout/GetCountries").then((e=>e.json())).then((t=>{s.EcommerceClassRepo.applyDropdownList(e,t)})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))}))}))}getStates(e,t){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/Checkout/GetStates",{method:"POST",body:s.EcommerceClassRepo.getJSON(t),headers:s.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((t=>{s.EcommerceClassRepo.applyDropdownList(e,t)})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))}))}))}getPaymentForm(){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/Payment/GetPaymentForm").then((e=>e.text())).then((e=>e)).catch((e=>(document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message)),null)))}))}createOrder(){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/Checkout/CreatOrder",{method:"POST",body:s.EcommerceClassRepo.getJSON({}),headers:s.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.orderFailed?document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message)):(this.orderGUID=e.orderGUID,document.body.dispatchEvent(this.paymentEvent))})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))}))}))}setCustomer(e){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/Checkout/SetCustomer",{method:"POST",body:s.EcommerceClassRepo.getJSON(e),headers:s.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.message&&document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message)),this.customerCreated=!0})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message)),this.customerCreated=!1}))}))}setBillingAddress(e){return n(this,void 0,void 0,(function*(){if(this.customerCreated)return s.EcommerceClassRepo.ajax("/Checkout/SetBillingAddress",{method:"POST",body:s.EcommerceClassRepo.getJSON(e),headers:s.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.message&&document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))}));setTimeout((()=>{this.setBillingAddress(e)}),500)}))}setShippingAddress(e){return n(this,void 0,void 0,(function*(){if(this.customerCreated)return s.EcommerceClassRepo.ajax("/Checkout/SetShippingAddress",{method:"POST",body:s.EcommerceClassRepo.getJSON(e),headers:s.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.message&&document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))}));setTimeout((()=>{this.setShippingAddress(e)}),500)}))}setShippingOption(e){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/Checkout/SetShippingOption",{method:"POST",body:s.EcommerceClassRepo.getJSON({optionID:e}),headers:s.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.message&&document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))}))}))}setPaymentOption(e){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/Checkout/SetPaymentOption",{method:"POST",body:s.EcommerceClassRepo.getJSON({optionID:e}),headers:s.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.message&&document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))}))}))}redeemCoupon(e){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/Checkout/AddCoupon",{method:"POST",body:s.EcommerceClassRepo.getJSON(e),headers:s.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.message&&document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))}))}))}removeCoupon(e){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/Checkout/RemoveCoupon",{method:"POST",body:s.EcommerceClassRepo.getJSON(e),headers:s.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.message&&document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))}))}))}getAddresses(e,t){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/Checkout/GetAddresses").then((e=>e.json())).then((o=>{s.EcommerceClassRepo.applyDropdownList(t,o),s.EcommerceClassRepo.applyDropdownList(e,o)})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))}))}))}getAddress(e){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/Checkout/GetAddress",{method:"POST",body:s.EcommerceClassRepo.getJSON(e),headers:s.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>e)).catch((e=>(document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message)),null)))}))}redirectToThankYouUrl(e){window.location.href=e}}},"./src/implementation/EcommerceClassRepo.ts":(e,t,o)=>{o.r(t),o.d(t,{EcommerceClassRepo:()=>n});var s=function(e,t,o,s){return new(o||(o=Promise))((function(n,r){function a(e){try{m(s.next(e))}catch(e){r(e)}}function c(e){try{m(s.throw(e))}catch(e){r(e)}}function m(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}m((s=s.apply(e,t||[])).next())}))};class n{static tokenInput(){return"__RequestVerificationToken"}static showAlert(e){console.log(e)}static showAlertEvent(e){return new CustomEvent("show-alert",{detail:e})}static getJSON(e){return JSON.stringify(e)}static getPostHeaders(e){var t=e||this.tokenInput(),o=document.getElementsByName(t),s=o.length>0?o[0].value:"",n={"Content-Type":"application/json"};return n[t.replace("__","")]=s,n}static closest(e,t){for(;e&&e.nodeName!==document.nodeName;e=e.parentNode)if(e.matches(t))return e;return null}static serializeForm(e){var t={};return new FormData(e).forEach((function(e,o,s){t[o]=e.valueOf()})),t}static replaceForm(e){return s(this,void 0,void 0,(function*(){e.preventDefault();var t=e.target;return this.ajax(t.action,{method:"POST",body:n.getJSON(this.serializeForm(t)),headers:this.getPostHeaders()}).then((e=>s(this,void 0,void 0,(function*(){var o=e.headers.get("content-type");if(null!==o&&-1!==o.indexOf("application/json")){var s=yield e.json();s.message&&document.body.dispatchEvent(n.showAlertEvent(s.message))}else{var r=yield e.text();if(r.length>0){var a=(new DOMParser).parseFromString(r,"text/html");t.replaceWith(a)}else t.remove()}}))))}))}static decodeHTML(e){var t,o=document.createElement("textarea");o.innerHTML=e;var s=document.createElement("div");return s.innerHTML=o.value,null===(t=s.firstChild)||void 0===t?void 0:t.getRootNode()}static applyDropdownList(e,t){var o=document.body.querySelector(e);if(o){var s="";if(t)for(var n=0;n<t.length;n++){var r=t[n];s+='<option value="'+r.value+'"'+(r.selected?' selected="true"':"")+">"+r.text+"</option>"}o.innerHTML=s}}static bootstrapValidate(e){var t=document.querySelector(e);t&&!t.classList.contains("was-validated")&&t.classList.add("was-validated")}static ajax(e,t,o){return s(this,void 0,void 0,(function*(){var s;return document.body.dispatchEvent(new CustomEvent("ajax-before",{detail:o})),(s=t?fetch(e,t):fetch(e)).then((e=>(document.body.dispatchEvent(new Event("ajax-after")),e))),s}))}}},"./src/implementation/ShoppingCartRepo.ts":(e,t,o)=>{o.r(t),o.d(t,{ShoppingCartRepo:()=>r});var s=o("./src/implementation/EcommerceClassRepo.ts"),n=function(e,t,o,s){return new(o||(o=Promise))((function(n,r){function a(e){try{m(s.next(e))}catch(e){r(e)}}function c(e){try{m(s.throw(e))}catch(e){r(e)}}function m(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}m((s=s.apply(e,t||[])).next())}))};class r{constructor(){this.returnShoppingEvent=new Event("return-shopping"),this.updateTotalsEvent=new Event("update-cart")}updateTotals(){return n(this,void 0,void 0,(function*(){var e=document.getElementById("free-shipping-promotion"),t=document.getElementById("cart-totals");s.EcommerceClassRepo.ajax("/ShoppingCart/GetTotals").then((e=>e.text())).then((e=>{var o=s.EcommerceClassRepo.decodeHTML(e)||"";null==t||t.replaceWith(o)})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))})),s.EcommerceClassRepo.ajax("/ShoppingCart/GetTotalTillFreeShipping").then((e=>e.text())).then((t=>{var o=s.EcommerceClassRepo.decodeHTML(t)||"";null==e||e.replaceWith(o)})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))}))}))}updateItem(e){return n(this,void 0,void 0,(function*(){return s.EcommerceClassRepo.ajax("/ShoppingCart/Update",{method:"POST",body:s.EcommerceClassRepo.getJSON(e.detail),headers:s.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((t=>{t.message||null==e.detail.priceEl?document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(t.message)):(console.log(e.detail),e.detail.priceEl.innerHTML=t.price)})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))}))}))}removeItem(e){var t,o;return n(this,void 0,void 0,(function*(){var n=e.detail.parent,r=null!==(o=null===(t=n.querySelector("input[name=ID]"))||void 0===t?void 0:t.value)&&void 0!==o?o:0;return s.EcommerceClassRepo.ajax("/ShoppingCart/RemoveItem",{method:"POST",body:r.toString(),headers:s.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{if(e.message)document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message));else{if(e.html){var t=s.EcommerceClassRepo.closest(n,".cart-content"),o=s.EcommerceClassRepo.decodeHTML(e.html)||document.createElement("span");t.insertBefore(o,n)}n.remove()}})).catch((e=>{document.body.dispatchEvent(s.EcommerceClassRepo.showAlertEvent(e.message))}))}))}returnShopping(){history.back()}updateItemEvent(e){return new CustomEvent("update-cart-item",{detail:e})}removeCartItemEvent(e){return new CustomEvent("remove-cart-item",{detail:{parent:e}})}}}},t={};function o(s){var n=t[s];if(void 0!==n)return n.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,o),r.exports}o.d=(e,t)=>{for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};(()=>{o.r(s),o.d(s,{InitializeEcommerceService:()=>a});var e=o("./src/implementation/AddToCartRepo.ts"),t=o("./src/implementation/CheckoutRepo.ts"),n=o("./src/implementation/EcommerceClassRepo.ts"),r=o("./src/implementation/ShoppingCartRepo.ts");function a(o){var s;switch(o){case"AddToCart":s=new e.AddToCartRepo;break;case"Checkout":s=new t.CheckoutRepo;break;case"EcommerceClass":s=n.EcommerceClassRepo;break;case"ShoppingCart":s=new r.ShoppingCartRepo}return s}window.InitializeEcommerceService=function(e){return a(e)}})()})();
//# sourceMappingURL=ecommerce.min.js.map