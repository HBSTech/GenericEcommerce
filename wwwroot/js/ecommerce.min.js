/*! For license information please see ecommerce.min.js.LICENSE.txt */
(()=>{"use strict";var e={"./src/implementation/AddToCartRepo.ts":(e,t,o)=>{o.r(t),o.d(t,{AddToCartRepo:()=>s});var n=o("./src/implementation/EcommerceClassRepo.ts"),r=function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function a(e){try{d(n.next(e))}catch(e){s(e)}}function c(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}d((n=n.apply(e,t||[])).next())}))};class s{constructor(){this.addedToCart=new Event("added-to-cart")}addItem(e){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/ShoppingCart/Add",{method:"POST",body:n.EcommerceClassRepo.getJSON(e.detail),headers:n.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.alert&&document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert)),document.body.dispatchEvent(this.addedToCart)})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))}))}))}addToCartEvent(e){var t={};Object.keys(e.dataset).filter((function(e){return/^customField/.test(e)})).forEach((function(o){t[o]=e.dataset[o]||""}));var o={sKUGUID:e.dataset.sku,quantity:e.dataset.quantity};return Object.keys(t).length>0&&(o.customFields=t),new CustomEvent("add-to-cart",{detail:o})}}},"./src/implementation/CheckoutRepo.ts":(e,t,o)=>{o.r(t),o.d(t,{CheckoutRepo:()=>s});var n=o("./src/implementation/EcommerceClassRepo.ts"),r=function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function a(e){try{d(n.next(e))}catch(e){s(e)}}function c(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}d((n=n.apply(e,t||[])).next())}))};class s{constructor(){this.paymentEvent=new Event("payment"),this.orderGUID="",this.createOrderEvent=new Event("create-order"),this.updateOrderEvent=new Event("update-order"),this.getCountriesEvent=new Event("get-countries"),this.customerCreated=null!=document.body.querySelector(".customer[data-customerexists]"),this.getAddressesEvent=new Event("get-addresses")}setOrderNoteEvent(e){return new CustomEvent("set-order-note",{detail:e})}redeemCouponEvent(e){return new CustomEvent("redeem-coupon",{detail:e})}removeCouponEvent(e){return new CustomEvent("remove-coupon",{detail:e})}getStatesEvent(e,t){return new CustomEvent("get-states",{detail:{selectId:e,countryId:t}})}getAddressEvent(e,t){return new CustomEvent("get-address",{detail:{addressID:e,addressType:t}})}paymentResultEvent(e){return new CustomEvent("payment-result",{detail:e})}setCustomerEvent(e){return new CustomEvent("set-customer",{detail:e})}setBillingAddressEvent(e){return new CustomEvent("set-billing-address",{detail:e})}setShippingAddressEvent(e){return new CustomEvent("set-shipping-address",{detail:e})}setShippingOptionEvent(e){return new CustomEvent("set-shipping-option",{detail:e})}setPaymentOptionEvent(e){return new CustomEvent("set-payment-option",{detail:e})}getOrder(){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/Checkout/GetOrder").then((e=>e.text())).then((e=>e)).catch((e=>(document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert)),null)))}))}getShippingOptions(e){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/Checkout/GetShippingOptions").then((e=>e.json())).then((t=>{n.EcommerceClassRepo.applyDropdownList(e,t)})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))}))}))}getPaymentOptions(){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/Checkout/GetPaymentOptions").then((e=>e.json())).then((e=>e)).catch((e=>(document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert)),null)))}))}getCountries(e){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/Checkout/GetCountries").then((e=>e.json())).then((t=>{n.EcommerceClassRepo.applyDropdownList(e,t)})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))}))}))}getStates(e,t){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/Checkout/GetStates",{method:"POST",body:n.EcommerceClassRepo.getJSON(t),headers:n.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((t=>{n.EcommerceClassRepo.applyDropdownList(e,t)})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))}))}))}getPaymentForm(){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/Payment/GetPaymentForm").then((e=>e.text())).then((e=>e)).catch((e=>(document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert)),null)))}))}createOrder(){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/Checkout/CreatOrder",{method:"POST",body:n.EcommerceClassRepo.getJSON({}),headers:n.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.orderFailed?document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.message)):(this.orderGUID=e.orderGUID,document.body.dispatchEvent(this.paymentEvent))})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))}))}))}setCustomer(e){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/Checkout/SetCustomer",{method:"POST",body:n.EcommerceClassRepo.getJSON(e),headers:n.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.alert&&document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert)),this.customerCreated=!0})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert)),this.customerCreated=!1}))}))}setBillingAddress(e){return r(this,void 0,void 0,(function*(){if(this.customerCreated)return n.EcommerceClassRepo.ajax("/Checkout/SetBillingAddress",{method:"POST",body:n.EcommerceClassRepo.getJSON(e),headers:n.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.alert&&document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))}));setTimeout((()=>{this.setBillingAddress(e)}),500)}))}setShippingAddress(e){return r(this,void 0,void 0,(function*(){if(this.customerCreated)return n.EcommerceClassRepo.ajax("/Checkout/SetShippingAddress",{method:"POST",body:n.EcommerceClassRepo.getJSON(e),headers:n.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.alert&&document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))}));setTimeout((()=>{this.setShippingAddress(e)}),500)}))}setShippingOption(e){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/Checkout/SetShippingOption",{method:"POST",body:n.EcommerceClassRepo.getJSON({optionID:e}),headers:n.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.alert&&document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))}))}))}setPaymentOption(e){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/Checkout/SetPaymentOption",{method:"POST",body:n.EcommerceClassRepo.getJSON({optionID:e}),headers:n.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.alert&&document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))}))}))}redeemCoupon(e){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/Checkout/AddCoupon",{method:"POST",body:n.EcommerceClassRepo.getJSON(e),headers:n.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.alert&&document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))}))}))}removeCoupon(e){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/Checkout/RemoveCoupon",{method:"POST",body:n.EcommerceClassRepo.getJSON(e),headers:n.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.alert&&document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))}))}))}getAddresses(e,t){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/Checkout/GetAddresses").then((e=>e.json())).then((o=>{n.EcommerceClassRepo.applyDropdownList(t,o),n.EcommerceClassRepo.applyDropdownList(e,o)})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))}))}))}getAddress(e){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/Checkout/GetAddress",{method:"POST",body:n.EcommerceClassRepo.getJSON(e),headers:n.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>e)).catch((e=>(document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert)),null)))}))}setOrderNote(e){return r(this,void 0,void 0,(function*(){n.EcommerceClassRepo.ajax("/Checkout/SetOrderNote",{method:"POST",body:n.EcommerceClassRepo.getJSON(e),headers:n.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>{e.message&&document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.message))})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.message))}))}))}redirectToThankYouUrl(e){window.location.href=e+(this.orderGUID?(e.includes("?")?"&":"?")+"o="+this.orderGUID:"")}}},"./src/implementation/EcommerceClassRepo.ts":(e,t,o)=>{o.r(t),o.d(t,{EcommerceClassRepo:()=>r});var n=function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function a(e){try{d(n.next(e))}catch(e){s(e)}}function c(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}d((n=n.apply(e,t||[])).next())}))};class r{static tokenInput(){return"__RequestVerificationToken"}static showAlert(e){console.log(e)}static showAlertEvent(e){return new CustomEvent("show-alert",{detail:e})}static getJSON(e){return JSON.stringify(e)}static getPostHeaders(e){var t=e||this.tokenInput(),o=document.getElementsByName(t),n=o.length>0?o[0].value:"",r={"Content-Type":"application/json"};return r[t.replace("__","")]=n,r}static closest(e,t){for(;e&&e.nodeName!==document.nodeName;e=e.parentNode)if(e.matches(t))return e;return null}static serializeForm(e){var t={};return new FormData(e).forEach((function(e,o,n){t[o]=e.valueOf()})),t}static replaceForm(e){return n(this,void 0,void 0,(function*(){e.preventDefault();var t=e.target;return this.ajax(t.action,{method:"POST",body:r.getJSON(this.serializeForm(t)),headers:this.getPostHeaders()}).then((e=>n(this,void 0,void 0,(function*(){var o=e.headers.get("content-type");if(null!==o&&-1!==o.indexOf("application/json")){var n=yield e.json();n.alert&&document.body.dispatchEvent(r.showAlertEvent(n.alert))}else{var s=yield e.text();if(s.length>0){var a=(new DOMParser).parseFromString(s,"text/html");t.replaceWith(a)}else t.remove()}}))))}))}static decodeHTML(e){var t,o=document.createElement("textarea");o.innerHTML=e;var n=document.createElement("div");return n.innerHTML=o.value,null===(t=n.firstChild)||void 0===t?void 0:t.getRootNode()}static applyDropdownList(e,t){var o=document.body.querySelector(e);if(o){var n="";if(t)for(var r=0;r<t.length;r++){var s=t[r];n+='<option value="'+s.value+'"'+(s.selected?' selected="true"':"")+">"+s.text+"</option>"}o.innerHTML=n}}static bootstrapValidate(e){var t=document.querySelector(e);t&&!t.classList.contains("was-validated")&&t.classList.add("was-validated")}static ajax(e,t,o){return n(this,void 0,void 0,(function*(){var n;return document.body.dispatchEvent(new CustomEvent("ajax-before",{detail:o})),(n=t?fetch(e,t):fetch(e)).then((e=>(document.body.dispatchEvent(new Event("ajax-after")),e))),n}))}}},"./src/implementation/ShoppingCartRepo.ts":(e,t,o)=>{o.r(t),o.d(t,{ShoppingCartRepo:()=>s});var n=o("./src/implementation/EcommerceClassRepo.ts"),r=function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function a(e){try{d(n.next(e))}catch(e){s(e)}}function c(e){try{d(n.throw(e))}catch(e){s(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}d((n=n.apply(e,t||[])).next())}))};class s{constructor(){this.returnShoppingEvent=new Event("return-shopping"),this.updateTotalsEvent=new Event("update-cart")}updateTotals(){return r(this,void 0,void 0,(function*(){var e=document.getElementById("free-shipping-promotion"),t=document.getElementById("cart-totals");n.EcommerceClassRepo.ajax("/ShoppingCart/GetTotals").then((e=>e.text())).then((e=>{var o=n.EcommerceClassRepo.decodeHTML(e)||"";null==t||t.replaceWith(o)})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))})),n.EcommerceClassRepo.ajax("/ShoppingCart/GetTotalTillFreeShipping").then((e=>e.text())).then((t=>{var o=n.EcommerceClassRepo.decodeHTML(t)||"";null==e||e.replaceWith(o)})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))}))}))}updateItem(e){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/ShoppingCart/Update",{method:"POST",body:n.EcommerceClassRepo.getJSON(e.detail),headers:n.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((t=>{t.alert||null==e.detail.priceEl?document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(t.alert)):(console.log(e.detail),e.detail.priceEl.innerHTML=t.price)})).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))}))}))}removeItem(e){return r(this,void 0,void 0,(function*(){return n.EcommerceClassRepo.ajax("/ShoppingCart/RemoveItem",{method:"POST",body:e.detail.ID.toString(),headers:n.EcommerceClassRepo.getPostHeaders()}).then((e=>e.json())).then((e=>(e.alert&&document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert)),e.html))).catch((e=>{document.body.dispatchEvent(n.EcommerceClassRepo.showAlertEvent(e.alert))}))}))}returnShopping(){history.back()}updateItemEvent(e){return new CustomEvent("update-cart-item",{detail:e})}removeCartItemEvent(e){return new CustomEvent("remove-cart-item",{detail:{ID:e}})}}}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,o),s.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{o.r(n),o.d(n,{InitializeEcommerceService:()=>a});var e=o("./src/implementation/AddToCartRepo.ts"),t=o("./src/implementation/CheckoutRepo.ts"),r=o("./src/implementation/EcommerceClassRepo.ts"),s=o("./src/implementation/ShoppingCartRepo.ts");function a(o){var n;switch(o){case"AddToCart":n=new e.AddToCartRepo;break;case"Checkout":n=new t.CheckoutRepo;break;case"EcommerceClass":n=r.EcommerceClassRepo;break;case"ShoppingCart":n=new s.ShoppingCartRepo}return n}window.InitializeEcommerceService=function(e){return a(e)}})()})();
//# sourceMappingURL=ecommerce.min.js.map